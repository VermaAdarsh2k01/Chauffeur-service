---
import Layout from '../layouts/Layout.astro';
import ContactForm from "@/components/ContactForm";
import ContactInfo from "@/components/ContactInfo";
import { sanityClient } from "../lib/sanity";

// Fetch contact page data from Sanity
const query = `*[_type == "contact"][0]{
  title,
  contactDetails[]{
    iconName,
    title,
    info,
    subInfo
  },
  whyChooseUs{
    title,
    features[]{
      iconName,
      title,
      description
    }
  },
  locationAndSocial{
    sectionTitle,
    location{
      address,
      city,
      mapsUrl
    },
    socialMediaText,
    socialLinks[]{
      platform,
      url
    }
  },
  backgroundImages{
    pattern1Green{
      "src": pattern1Green.asset->url,
      alt
    },
    pattern2Green{
      "src": pattern2Green.asset->url,
      alt
    },
    pattern1{
      "src": pattern1.asset->url,
      alt
    },
    pattern2{
      "src": pattern2.asset->url,
      alt
    }
  }
}`;

// Fetch the contact data with error handling
let contactData;
try {
  contactData = await sanityClient.fetch(query);
} catch (error) {
  console.warn('Failed to fetch contact data from Sanity:', error);
  contactData = null;
}
---

<Layout>
     <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 mt-16">
        <!-- Page Header -->
        <div class="text-center mb-16">
            <p class="text-sm uppercase tracking-wider text-gray-500 mb-4">
                CONTACT US
            </p>
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
                Get in Touch
            </h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                Ready to experience premium car rental services? We're here to help you with all your transportation needs.
            </p>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
            <ContactForm client:load />
            <ContactInfo client:load data={contactData} />
        </div>
    </div>
</Layout>
