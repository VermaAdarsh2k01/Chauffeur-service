---
import Hero from "../components/Hero";
import Welcome from "../components/Welcome.astro";
import Layout from "../layouts/Layout.astro";
import VehicleFleet from "../components/VehicleFleet";
import KeyFeatures from "../components/KeyFeatures";
import ServiceHighlights from "../components/ServiceHighlights";
import DownloadCTA from "../components/DownloadCTA";
import FAQ from "../components/FAQ";
import { sanityClient } from "../lib/sanity";

// Fetch all homepage data in one query
const query = `*[_type == "homePage"][0]{
  title,
  hero{
    mainHeading,
    description,
    heroImage{
      "src": src.asset->url,
      alt
    },
    partnerLogos[]{
      "src": src.asset->url,
      alt
    }
  },
  vehicleFleet{
    subtitle,
    sectionTitle,
    sectionDescription,
    vehicles[]{
      name,
      image{
        "src": src.asset->url,
        alt
      },
      description,
      buttonText,
      buttonLink
    }
  },
  serviceHighlights{
    subtitle,
    sectionTitle,
    leftColumn{
      title,
      description,
      image{
        "src": src.asset->url,
        alt
      }
    },
    middleColumn{
      topRow{
        title,
        description,
        image{
          "src": src.asset->url,
          alt
        }
      },
      bottomRow{
        title,
        description,
        statistics{
          leftStat{
            value,
            label
          },
          rightStat{
            value,
            label
          }
        }
      }
    },
    rightColumn{
      title,
      description,
      image{
        "src": src.asset->url,
        alt
      }
    }
  },
  keyFeatures{
    subtitle,
    sectionTitle,
    sectionDescription,
    features[]{
      icon,
      title,
      description
    }
  },
  faq{
    title,
    subtitle,
    questions[]{
      id,
      question,
      answer
    }
  }
}`;

// Fetch the data
const pageData = await sanityClient.fetch(query);
---

<Layout>
  <Hero client:load data={pageData?.hero} />

  <section class="py-4 sm:py-16 lg:py-12">
    <VehicleFleet client:load data={pageData?.vehicleFleet} />
  </section>

  <section class="py-4 sm:py-16 lg:py-12">
    <ServiceHighlights client:load data={pageData?.serviceHighlights} />
  </section>

  <section class="py-4 sm:py-16 lg:py-0">
    <KeyFeatures client:load data={pageData?.keyFeatures} />
  </section>

  <section class="py-4 sm:py-16 lg:py-12">
    <FAQ client:load data={pageData?.faq} />
  </section>

  <section class="py-4 sm:py-16 lg:py-12 px-4 sm:px-6">
    <DownloadCTA client:load />
  </section>
</Layout>
